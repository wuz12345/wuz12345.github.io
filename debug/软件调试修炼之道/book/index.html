
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="wuzhuang">
      
      
        <meta name="author" content="wuzhuang">
      
      
        <link rel="canonical" href="https://wuz12345.github.io/debug/%E8%BD%AF%E4%BB%B6%E8%B0%83%E8%AF%95%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/book/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.16">
    
    
      
        <title>1. 山重水复疑无路 - wuzhuang</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1c3799f8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="wuzhuang" class="md-header__button md-logo" aria-label="wuzhuang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            wuzhuang
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1. 山重水复疑无路
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wuz12345/mynote/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="wuzhuang" class="md-nav__button md-logo" aria-label="wuzhuang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    wuzhuang
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wuz12345/mynote/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        简介
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        关于
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          LearnGo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LearnGo" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          LearnGo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnGo/Read/" class="md-nav__link">
        简介
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          LearnC++
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LearnC++" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          LearnC++
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          模板和泛型编程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="模板和泛型编程" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          模板和泛型编程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E6%A8%A1%E7%89%88%E5%92%8C%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/READ/" class="md-nav__link">
        简介
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E6%A8%A1%E7%89%88%E5%92%8C%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/%E7%B1%BB%E6%A8%A1%E6%9D%BF/" class="md-nav__link">
        类模板
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E6%A8%A1%E7%89%88%E5%92%8C%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/%E6%97%A0%E7%B1%BB%E5%9E%8B%E6%A8%A1%E6%9D%BF%E5%8F%82%E6%95%B0/" class="md-nav__link">
        非类型模板参数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E6%A8%A1%E7%89%88%E5%92%8C%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%A8%A1%E6%9D%BF/" class="md-nav__link">
        可变类型模板
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E6%8B%B7%E8%B4%9D%E8%B5%8B%E5%80%BC/" class="md-nav__link">
        拷贝赋值
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Effiective Modern C++
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Effiective Modern C++" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Effiective Modern C++
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/Effective%20C%2B%2B/Item01/" class="md-nav__link">
        item1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/Effective%20C%2B%2B/Item02/" class="md-nav__link">
        item2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/Effective%20C%2B%2B/Item07/" class="md-nav__link">
        item7
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LearnC%2B%2B/%E5%B7%A6%E5%80%BC%E4%B8%8E%E5%8F%B3%E5%80%BC/" class="md-nav__link">
        左值与右值
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          LeetCode刷题
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LeetCode刷题" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          LeetCode刷题
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LeetCode%20%E5%88%B7%E9%A2%98/Zigzag-Conversion/" class="md-nav__link">
        之字形转换
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../LeetCode%20%E5%88%B7%E9%A2%98/%E7%BA%BF%E6%80%A7%E8%A1%A8/" class="md-nav__link">
        线性表
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          有趣的知识
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="有趣的知识" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          有趣的知识
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%9F%A5%E8%AF%86/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA/" class="md-nav__link">
        正则表达式与有限状态机
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%9F%A5%E8%AF%86/max_and_min/" class="md-nav__link">
        max()函数怎么写
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          webRTC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="webRTC" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          webRTC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../webrtc/FEC/FEC/" class="md-nav__link">
        FEC
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/wuz12345/mynote/edit/master/docs/debug/软件调试修炼之道/book.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="1">1. 山重水复疑无路<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<p>有效的调试步骤：</p>
<ul>
<li>弄清楚为什么运行异常</li>
<li>修复问题</li>
<li>避免破坏其他部分</li>
<li>保持或者提高代码总体质量（可读性，架构，测试覆盖，性能等）</li>
<li>确保同样问题不要再次发生</li>
</ul>
<p>实证方法：构建实验，观察结果</p>
<p>核心调试过程：</p>
<ul>
<li>问题重现</li>
<li>问题诊断</li>
<li>缺陷修复</li>
<li>反思，吸取教训</li>
</ul>
<p>澄清问题：</p>
<ul>
<li>发生了什么，应该发生什么</li>
<li>一次一个问题</li>
<li>先检查简单的事情</li>
</ul>
<h1 id="2">2  重现问题<a class="headerlink" href="#2" title="Permanent link">&para;</a></h1>
<h3 id="21">2.1 重现第一，提问第二<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>如何重现：</p>
<ul>
<li>明确开始要做的事情（比如缺陷报告的步骤）</li>
<li>抓住重点</li>
</ul>
<p>控制因素：</p>
<ul>
<li>软件本身</li>
<li>运行环境</li>
<li>提供的输入</li>
</ul>
<h3 id="22">2.2 控制软件<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h3 id="23">2.3 控制环境<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<p>可能包含所有环境</p>
<h3 id="24">2.4 控制输入<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<p>推测可能输入:</p>
<ul>
<li>回溯工作</li>
<li>探测可能输入值</li>
<li>边界分析</li>
<li>分之覆盖</li>
<li>利用错误条件</li>
<li>引入随机性：模糊测试；生成模糊器；变异模糊器</li>
<li>记录输入值</li>
<li>日志框架。可以开启 or 关闭；日志级别；上下文（代码行数等）；分析工具（ELK）</li>
<li>外部日志。代理服务器等</li>
<li>负载和压力。有些缺陷只有在某种压力才表现出来（高负载网络流量，有限的可用内存）</li>
</ul>
<h3 id="25">2.5 改进问题重现<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<h5 id="251-">2.5.1 最小化反馈周期。编辑-执行-重新问题时间最短<a class="headerlink" href="#251-" title="Permanent link">&para;</a></h5>
<ul>
<li>尽可能简单，通过二分法快速定位</li>
<li>自动化最小输入</li>
<li>最大限度减少所需时间，比如营造资源耗尽的局面。</li>
</ul>
<h5 id="252">2.5.2 不确定缺陷变为确定<a class="headerlink" href="#252" title="Permanent link">&para;</a></h5>
<p>软件之美在于确定性，但是不确定性从哪里来？</p>
<ul>
<li>开始于不可预知的初始状态。从未经初始化的内存读取数据(强制初始化，或者内存完整性检测软件)</li>
<li>与外部系统交互: 精确控制从外部系统接收了什么</li>
<li>故意使用随机性: 伪随机数</li>
<li>多线程: 通过 sleep 等增加出现竞争的可能性</li>
</ul>
<h5 id="253">2.5.3 自动化<a class="headerlink" href="#253" title="Permanent link">&para;</a></h5>
<ul>
<li>自动化测试</li>
<li>重放日志</li>
</ul>
<h3 id="26">2.6 无法重现怎么办<a class="headerlink" href="#26" title="Permanent link">&para;</a></h3>
<ul>
<li>缺陷真的存在么？</li>
<li>在相同区域解决不同问题</li>
<li>让其他人参与其中。不同人的视角</li>
<li>充分利用用户群体</li>
<li>推测法：逻辑推理，想象出错的可能性</li>
</ul>
<h1 id="3">3 诊断<a class="headerlink" href="#3" title="Permanent link">&para;</a></h1>
<h3 id="31">3.1 不要急于动手，试试科学方法<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<ul>
<li>调试方法：</li>
<li>根据你对软件运行情况的理解，提出一个可以导致这种情况的假设</li>
<li>设计一个实验，证明假设是否正确</li>
<li>如果无法证明你的假设，重新设计然后再次实验</li>
<li>
<p>如果实验支持你的假设，继续证明，知道能够证明或者证伪</p>
</li>
<li>
<p>实验必须起到验证的作用。(与他人争辩试图推翻你的假设)</p>
</li>
<li>
<p>每次只做一个修改。多处修改可能导致错误的结论。</p>
</li>
<li>
<p>记录你做的调试。定期回顾你已经尝试过的实验和学到的东西，使用日记簿或者电子笔记。</p>
</li>
<li>
<p>不要忽略任何细节。凡是你不明白的都是潜在的缺陷。(Anything that you don&rsquo;t understand is potentially a bug)</p>
</li>
<li>写出假设。曾经做过的假设写到纸上</li>
<li>可以跟踪详细信息</li>
<li>确保不会忘记需要做的事情</li>
<li>短暂休息，可以尝试头脑风暴</li>
</ul>
<h3 id="32">3.2 相关策略<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<h5 id="321">3.2.1 插桩<a class="headerlink" href="#321" title="Permanent link">&para;</a></h5>
<p>使用日志，但是不要引入额外的副作用影响了原始代码逻辑。增加日志的时候，不要同时修改代码逻辑。</p>
<h5 id="322">3.2.2 分而治之<a class="headerlink" href="#322" title="Permanent link">&para;</a></h5>
<p>二分法，排除一部分模块或者代码的问题。</p>
<h5 id="323">3.2.3 源码控制工具<a class="headerlink" href="#323" title="Permanent link">&para;</a></h5>
<p>git 找出历史提交，分析引入缺陷的提交</p>
<h5 id="324">3.2.4 聚焦差异<a class="headerlink" href="#324" title="Permanent link">&para;</a></h5>
<p>找到特殊用例，缺陷的边界</p>
<h5 id="325">3.2.5 向他人学习<a class="headerlink" href="#325" title="Permanent link">&para;</a></h5>
<p>网络搜索，同事求助</p>
<h5 id="326">3.2.6 奥卡姆剃刀<a class="headerlink" href="#326" title="Permanent link">&para;</a></h5>
<p>其他条件相同情况下，最简单的解释是最好的。</p>
<h3 id="33">3.3 调试器<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<p>代码检查，断点，单步调试，检查运行状态</p>
<ul>
<li>开发初期调试器非常有用</li>
<li>让代码以特定方式运行</li>
<li>探究看不懂的代码</li>
</ul>
<p>随着经验增加和TDD 思想出现，调试器使用会变少</p>
<h3 id="34">3.4 陷阱<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<ul>
<li>你做的修改是正确的么？如果没有，说明你没修改到点子上。尝试引入明显的失败比如断言让其暴露出来</li>
<li>验证假设。思维定势造成的先验假设可能会让你得不到结果</li>
<li>多重原因。问题有时候是复杂的，</li>
<li>对问题进行隔离，找到一个方法重现缺陷。</li>
<li>先找同一个区域内其他较明显的缺陷，扫清障碍，让缺陷更加明显</li>
<li>查出变化并且控制它。第三方系统或者数据库。</li>
</ul>
<h3 id="35">3.5 思维游戏<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<ul>
<li>旁观调试法（小黄鸭）。求助其他人。倾听；提问；留意没有探究过的地方；了解接下来将会发生什么。解释问题会帮你理清思路</li>
<li>角色扮演</li>
<li>换换脑筋。潜意识帮助你</li>
<li>做些改变，什么改变都行。出去散个步最好</li>
<li>福尔摩斯原则：当你排除了一切不可能之后，无论它多么不可思议，它也一定是真相</li>
</ul>
<h3 id="36">3.6 验证诊断<a class="headerlink" href="#36" title="Permanent link">&para;</a></h3>
<ul>
<li>向其他人解释你的诊断</li>
<li>检查源代码原始副本</li>
<li>多和其他人讨论，并假设你是错的</li>
</ul>
<h1 id="4">4 修复缺陷<a class="headerlink" href="#4" title="Permanent link">&para;</a></h1>
<h3 id="41">4.1 清楚障碍<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<p>从一个干净的代码树开始修改。</p>
<h3 id="42">4.2 测试<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<ul>
<li>保证现有测试都可以通过</li>
<li>添加一个或者多个新的测试程序</li>
<li>修复 bug</li>
<li>证明修复起了作用</li>
<li>证明回归测试没有失败</li>
</ul>
<h3 id="43">4.3 修复原因而非修复现象<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<p>理解问题的症结所在</p>
<h3 id="44">4.4 重构<a class="headerlink" href="#44" title="Permanent link">&para;</a></h3>
<p>重构：改善代码设计而不改变其行为的过程。</p>
<ul>
<li>重构应该在有全面单测套件的安全网中才可以安全修改既有代码</li>
<li>重构或者修改功能，不能同时进行。 重构的同时决不能修改代码功能，同样也不能修复有缺陷的代码。(一次只做一件事)</li>
</ul>
<h3 id="45">4.5 签入<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<p>一次逻辑修改只做一次签入。方便快速回滚和定位代码问题。</p>
<h3 id="46">4.6 审查代码<a class="headerlink" href="#46" title="Permanent link">&para;</a></h3>
<h1 id="5">5. 反思<a class="headerlink" href="#5" title="Permanent link">&para;</a></h1>
<h3 id="51">5.1 这到底是怎么搞的<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<ul>
<li>如果缺陷仅仅发生在少数用户身上，你就要反思是否还有其他问题？</li>
<li>一个你以为会失败的 case，结果却成功了</li>
</ul>
<h3 id="52">5.2 哪里除出了问题？<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<p>五个为什么？</p>
<ul>
<li>我们已经做到了么？</li>
<li>根本原因分析。责备没有用</li>
<li>需求是否正确，是否是模糊的，误解了</li>
<li>架构或者设计。有没有正确按照设计来做</li>
<li>测试。测试覆盖率足够么？</li>
<li>构造</li>
</ul>
<h3 id="53">5.3 它不会再发生了<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<ul>
<li>自动验证，检查是否存在问题</li>
<li>和同事交流</li>
<li>重构代码避免被不正确使用</li>
<li>过程。检查工作过程</li>
</ul>
<h3 id="54">5.4 关闭循环<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<p>编码规范；测试规范；文档规范；报告/跟踪过程；设计指南；性能需求</p>
<h1 id="6">6. 发现代码存在问题<a class="headerlink" href="#6" title="Permanent link">&para;</a></h1>
<h3 id="61">6.1 缺陷追踪<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<ul>
<li>使用缺陷追踪系统。</li>
<li>缺陷报告。具体，明确，详细的。</li>
<li>环境和配置报告。自动收集环境和配置信息，不要指望用户</li>
</ul>
<h3 id="62">6.2 与用户合作<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<ul>
<li>简化流程</li>
<li>自动化</li>
<li>提供多种选择</li>
<li>尽量简单</li>
<li>模板不要死板</li>
<li>尊重用户隐私</li>
</ul>
<p>有效的沟通：</p>
<ul>
<li>心智模式。从用户角度设想一下</li>
<li>和非技术人员沟通</li>
<li>发布缺陷数据库</li>
<li>隐私问题；提供反馈；拜访用户</li>
</ul>
<h3 id="63">6.3 与支持人员协同工作<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<p>学会沟通；和 QA 搞好关系，以便在修复缺陷的过程中得到帮助。</p>
<h1 id="7">7. 务实的零容忍策略<a class="headerlink" href="#7" title="Permanent link">&para;</a></h1>
<h3 id="71">7.1 缺陷优先<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<p>早期修复缺陷是一个好的策略：</p>
<ul>
<li>可能发现缺陷的过程（比如测试、代码审查、用户使用等）要连续贯穿整个开发过程</li>
<li>
<p>缺陷修复优先于其他任何事情</p>
</li>
<li>
<p>质量底下具有传染性。</p>
</li>
<li>破窗理论。发现缺陷就立马解决，不要留破窗户</li>
</ul>
<h3 id="72">7.2 调试的思维模式<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<p>既要完美，又要实用。接近零容忍，但是用务实的心态去实现。</p>
<h3 id="73">7.3 自己来解决质量问题<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<p>面对大量bug 如何摆脱困境？</p>
<ul>
<li>没有灵丹妙药。</li>
<li>停止开发有缺陷的程序。阻止事情恶化。</li>
<li>从不干净的代码中分离干净代码</li>
<li>缺陷分类</li>
<li>缺陷闪电战。集中较短时间专门修复缺陷</li>
</ul>
<h1 id="8">8 特殊案例<a class="headerlink" href="#8" title="Permanent link">&para;</a></h1>
<h3 id="81">8.1 修复已经发布软件<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<p>集中精力减少风险。</p>
<h3 id="82">8.2 向后兼容<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<p>将确定兼容问题加入到你的缺陷修复检查列表中</p>
<ul>
<li>提供迁移方法</li>
<li>实现一个兼容模式。比如 word 就是这么做的</li>
<li>提供预警。java api 升级</li>
<li>不修复。极少数情况是一个务实的方案</li>
</ul>
<h3 id="83">8.3 并发<a class="headerlink" href="#83" title="Permanent link">&para;</a></h3>
<p>简单和控制</p>
<p>让并发软件中问题更少地发生不是一个可取修复办法。
修复并发缺陷时，避免实用 sleep 方法。</p>
<h3 id="84">8.4 海森堡缺陷<a class="headerlink" href="#84" title="Permanent link">&para;</a></h3>
<p>观察者效应。尽量减少收集信息带来的副作用</p>
<h3 id="85">8.5 性能缺陷<a class="headerlink" href="#85" title="Permanent link">&para;</a></h3>
<ul>
<li>寻找瓶颈。性能分析器。通过检查代码有时候预测瓶颈是不可靠的。</li>
<li>没有瓶颈呢？是否是资源耗尽；垃圾收集；缓存丢失等</li>
</ul>
<h3 id="86">8.6 嵌入式软件<a class="headerlink" href="#86" title="Permanent link">&para;</a></h3>
<p>仿真器；硬件还是软件问题；</p>
<h3 id="87">8.7 第三方软件缺陷<a class="headerlink" href="#87" title="Permanent link">&para;</a></h3>
<ul>
<li>不要太快去指责。<strong>首先怀疑你自己的代码</strong></li>
<li>报告别人代码中的缺陷。慎重自己直接修复</li>
<li>linux 法则：眼睛足够多，bug 无处藏</li>
<li>报告问题：检查文档；尽可能给出足够信息</li>
</ul>
<h1 id="9">9. 理想的调试环境<a class="headerlink" href="#9" title="Permanent link">&para;</a></h1>
<h3 id="91">9.1 自动化测试<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<ul>
<li>结果明确，通过还是失败</li>
<li>环境独立</li>
<li>所有测试可以独立运行</li>
<li>全面覆盖</li>
</ul>
<h3 id="92">9.2 源程序控制<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<ul>
<li>合理使用代码分支</li>
<li>坚持分之单一层级</li>
<li>设计 CI 构建所有正在活跃的分之</li>
<li>小的修改更加容易理解，合并和撤销</li>
<li>不要一次合并多个分之</li>
</ul>
<h3 id="93">9.3 自动构建<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<ul>
<li>自动化构建整个过程，从开始到完成。</li>
<li>持续集成</li>
<li>静态分析(lint工具)。不要依赖未定义行为；谨慎对待编辑器警告</li>
</ul>
<h1 id="10">10. 让软件学会自己寻找缺陷<a class="headerlink" href="#10" title="Permanent link">&para;</a></h1>
<h3 id="101">10.1 假设和断言<a class="headerlink" href="#101" title="Permanent link">&para;</a></h3>
<p>fail early，使用断言保护代码。</p>
<p>契约式编程：</p>
<ul>
<li>先决条件。不如参数不能是空</li>
<li>后置条件。调用之后保持的条件，比如一个 http addHeader() 方法调用之后 headers map 比原来多一个</li>
<li>不变量。方法调用之前它的先决条件被满足就始终为真的数据。</li>
</ul>
<p>支持开启和关闭断言功能。</p>
<p>软件在产品阶段应该是鲁棒的，在调试阶段应该是脆弱的。
断言是一个缺陷检测机制，不是一个错误处理机制。</p>
<h3 id="102">10.2 调试版本<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<p>不要等待资源泄露表现出来，主动今早地检测它们。</p>
<h1 id="11">11. 反模式<a class="headerlink" href="#11" title="Permanent link">&para;</a></h1>
<h3 id="111">11.1 夸大优先级<a class="headerlink" href="#111" title="Permanent link">&para;</a></h3>
<p>质量差才是导致大量缺陷的原因。</p>
<ul>
<li>定期清理缺陷</li>
<li>控制优先级</li>
<li>不要使用数字表示优先级</li>
</ul>
<h3 id="112">11.2 超级巨星<a class="headerlink" href="#112" title="Permanent link">&para;</a></h3>
<p>巨星效应会破坏团队。一开始匆忙实现看似非常高效率(所以被称为&rdquo;巨星&rdquo;），但是遗留了一堆棘手的烂摊子。</p>
<ul>
<li>确保完成就是完成，需要功能被测试过了，检查过了，记录文档了。</li>
<li>任务分解为小任务</li>
<li>自负自责。谁搞得 bug 谁负责修理它。（有时候你可能要考虑拍屁股走人了，比如一堆 c 艹的烂摊子？？？）</li>
</ul>
<h3 id="113">11.3 维护团队<a class="headerlink" href="#113" title="Permanent link">&para;</a></h3>
<p>最终开发和维护都要由一个团队来完成，保持连续性。不要区分开发和维护团队。</p>
<h3 id="114">11.4 救火模式<a class="headerlink" href="#114" title="Permanent link">&para;</a></h3>
<p>退一步，找出根本原因，再去解决问题</p>
<p>救火模式永远也不会修复任何质量问题。</p>
<h3 id="115">11.5 重写<a class="headerlink" href="#115" title="Permanent link">&para;</a></h3>
<p>从心理学角度来看，开发新代码比重写旧的代码让人更加舒服。天生乐观会让我们低估了复制旧功能要付出的精力和时间。
避免彻头彻尾重写，增量式重写代码。</p>
<h3 id="116">11.6 没有代码所有权<a class="headerlink" href="#116" title="Permanent link">&para;</a></h3>
<p>集体代码所有权（极限编程）</p>
<h3 id="117">11.7 魔法<a class="headerlink" href="#117" title="Permanent link">&para;</a></h3>
<p>任何你不理解的事情都可能隐藏有缺陷。唯一的方法就是纪律，把你不理解的事物都当成缺陷。</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.3a4b43e5.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>